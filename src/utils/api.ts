const API_BASE=import.meta.env.VITE_API_BASE||'http://localhost:5000';export async function api(p,opt={}){const t=localStorage.getItem('token');const h={'Content-Type':'application/json',...(opt.headers||{})};if(t)h['Authorization']=`Bearer ${t}`;const r=await fetch(`${API_BASE}${p}`,{...opt,headers:h});const d=await r.json().catch(()=>({}));if(!r.ok)throw new Error(d.message||'Request failed');return d;}